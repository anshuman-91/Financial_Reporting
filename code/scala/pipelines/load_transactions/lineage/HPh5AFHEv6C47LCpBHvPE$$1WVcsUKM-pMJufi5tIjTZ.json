{
  "id" : "HPh5AFHEv6C47LCpBHvPE$$1WVcsUKM-pMJufi5tIjTZ",
  "name" : "HPh5AFHEv6C47LCpBHvPE$$1WVcsUKM-pMJufi5tIjTZ",
  "component" : "WindowFunction",
  "transformations" : [ {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "acc_id",
      "exprId" : 1762
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "acc_id",
      "exprId" : 1762
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "person_id",
      "exprId" : 1763
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "person_id",
      "exprId" : 1763
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "product_id",
      "exprId" : 1764
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "product_id",
      "exprId" : 1764
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "balance",
      "exprId" : 1765
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "balance",
      "exprId" : 1765
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "business_date",
      "exprId" : 1766
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "business_date",
      "exprId" : 1766
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "import_ts",
      "exprId" : 1767
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "import_ts",
      "exprId" : 1767
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "row_num",
      "exprId" : 1768
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "row_num",
      "exprId" : 1768
    }
  }, {
    "sources" : [ {
      "port" : "",
      "name" : "prev_balance",
      "exprId" : 1776
    } ],
    "destination" : {
      "port" : "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg",
      "name" : "prev_balance",
      "exprId" : 1776
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "acc_id",
      "exprId" : 1762
    } ],
    "destination" : {
      "port" : "",
      "name" : "acc_id",
      "exprId" : 1762
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "person_id",
      "exprId" : 1763
    } ],
    "destination" : {
      "port" : "",
      "name" : "person_id",
      "exprId" : 1763
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "product_id",
      "exprId" : 1764
    } ],
    "destination" : {
      "port" : "",
      "name" : "product_id",
      "exprId" : 1764
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "balance",
      "exprId" : 1765
    } ],
    "destination" : {
      "port" : "",
      "name" : "balance",
      "exprId" : 1765
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "business_date",
      "exprId" : 1766
    } ],
    "destination" : {
      "port" : "",
      "name" : "business_date",
      "exprId" : 1766
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "import_ts",
      "exprId" : 1767
    } ],
    "destination" : {
      "port" : "",
      "name" : "import_ts",
      "exprId" : 1767
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "row_num",
      "exprId" : 1768
    } ],
    "destination" : {
      "port" : "",
      "name" : "row_num",
      "exprId" : 1768
    }
  }, {
    "sources" : [ {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "balance",
      "exprId" : 1765
    }, {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "acc_id",
      "exprId" : 1762
    }, {
      "port" : "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT",
      "name" : "business_date",
      "exprId" : 1766
    } ],
    "destination" : {
      "port" : "",
      "name" : "prev_balance",
      "exprId" : 1776
    },
    "transformation" : "lag(`balance`, 1, NULL) OVER (PARTITION BY `acc_id` ORDER BY `business_date` ASC NULLS FIRST ROWS BETWEEN -1 FOLLOWING AND -1 FOLLOWING)"
  } ],
  "inputs" : {
    "TXkmx6n9CCT60Dka1wrfD$$bIkPirZytHTi0L7gE2-JT" : {
      "columns" : [ {
        "name" : "acc_id",
        "exprId" : 1762
      }, {
        "name" : "person_id",
        "exprId" : 1763
      }, {
        "name" : "product_id",
        "exprId" : 1764
      }, {
        "name" : "balance",
        "exprId" : 1765
      }, {
        "name" : "business_date",
        "exprId" : 1766
      }, {
        "name" : "import_ts",
        "exprId" : 1767
      }, {
        "name" : "row_num",
        "exprId" : 1768
      } ]
    }
  },
  "outputs" : {
    "5GSIWcQ-dHndjzmOiALzu$$bomiDwlK7nsoFbE85ULEg" : {
      "columns" : [ {
        "name" : "acc_id",
        "exprId" : 1762
      }, {
        "name" : "person_id",
        "exprId" : 1763
      }, {
        "name" : "product_id",
        "exprId" : 1764
      }, {
        "name" : "balance",
        "exprId" : 1765
      }, {
        "name" : "business_date",
        "exprId" : 1766
      }, {
        "name" : "import_ts",
        "exprId" : 1767
      }, {
        "name" : "row_num",
        "exprId" : 1768
      }, {
        "name" : "prev_balance",
        "exprId" : 1776
      } ]
    }
  }
}